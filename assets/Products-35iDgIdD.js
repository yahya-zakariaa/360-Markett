import{r as a,c as L,U as W,W as S,P as T,j as e,d as $,e as D,L as E,f as I,_ as c}from"./index-W8j7LK9M.js";function U(){const{addToCart:m,userCart:o,getUserCart:d}=a.useContext(L),{userToken:u}=a.useContext(W),{addToWishList:y,wishlist:n,getWishlist:x}=a.useContext(S),{getHomeProducts:w,homeProducts:r}=a.useContext(T),[b,i]=a.useState(!0),[v,C]=a.useState([]);async function N(){i(!0);try{await x(),await d()}catch{}finally{i(!1)}}a.useEffect(()=>{localStorage.getItem("userToken")&&N()},[]);async function A(){try{await w()}catch{}finally{C(r==null?void 0:r.filter(s=>s.priceAfterDiscount)),i(!1)}}a.useEffect(()=>{A()},[r]);async function P(s){if(u)try{await m(s),await d()}catch{}finally{c.success("Added to cart",{position:"top-right"})}else c.error("Please login first",{duration:4e3})}async function k(s){u?await y(s).then(()=>{x().then(()=>{c.success("Added to wishlist",{position:"top-right"})})}):c.error("Please login first",{duration:4e3})}return b?e.jsx($,{}):e.jsx(e.Fragment,{children:v.map(s=>{var p,h,g;const l=(p=n==null?void 0:n.data)==null?void 0:p.some(t=>t.id===s.id),f=(g=(h=o==null?void 0:o.data)==null?void 0:h.products)==null?void 0:g.some(t=>t.product.id===s.id);return e.jsx("div",{className:"card-container  px-3 lg:px-3 lg:w-1/4 md:w-1/3 w-full sm:w-1/2",children:e.jsxs("div",{className:"product-card border border-gray-400  group bg-gray-100 rounded-xl overflow-hidden w-full  transition-all duration-300",children:[e.jsxs("div",{className:"card-img relative flex items-center justify-center w-full p-0 sm:h-[30%] h-[40%] overflow-hidden",children:[e.jsx("button",{disabled:l,onClick:t=>{k(s.id),t.stopPropagation()},className:`absolute top-4 text-[25px] right-4 z-30 ${l?"text-red-700":""}`,children:l?e.jsx("i",{class:"fa-solid fa-heart"}):e.jsx("i",{class:"fa-regular fa-heart"})}),s.priceAfterDiscount&&e.jsx("div",{className:"bg-red-700 z-50 w-[125px] h-[40px] absolute top-[10px] left-[-35px] rotate-[-45deg] flex justify-center items-center text-white",children:"Sale"}),e.jsx(D.Carousel,{className:"w-full mx-auto h-full slider overflow-hidden",navigation:!1,loop:!0,children:s.images.map((t,j)=>e.jsx("img",{src:t,onLoad:()=>{i(!1)},decoding:"async",className:"object-cover w-full h-full",alt:`image ${j+1}`},j))})]}),e.jsxs("div",{className:"card-body px-3 py-5 h-[180px]",children:[e.jsx("h2",{className:"card-category mb-1 hover:underline text-blue-700 ",children:s.category.name}),e.jsx(E,{to:`/product/${s.id}`,children:e.jsx("h2",{className:"card-title mb-1 hover:underline",children:s.title?s.title.split(" ").slice(0,4).join(" "):e.jsx(I,{width:200})})}),e.jsx("div",{className:"product-rateing my-[3px]",children:e.jsxs("p",{children:[e.jsx("i",{class:"fa-solid fa-star me-1 text-yellow-600"}),s.ratingsAverage," ( ",s.ratingsQuantity,")"]})}),e.jsxs("div",{className:"card-footer flex justify-between items-center",children:[s.priceAfterDiscount?e.jsxs("p",{className:"card-price flex items-center text-lg font-bold",children:["$",s.priceAfterDiscount,e.jsxs("s",{className:"text-gray-600 text-sm ms-1  font-normal ",children:[" ","$",s.price]})]}):e.jsxs("p",{children:["$",s.price]}),e.jsx("button",{disabled:f,onClick:t=>{P(s.id),t.stopPropagation()},className:" text-[25px] lg:text-[35px] mr-4   flex justify-center items-center",children:f?e.jsx("i",{class:"fa-solid fa-circle-check"}):e.jsx("i",{class:"fa-solid fa-circle-plus"})})]})]})]})},s.id)})})}export{U as default};
